{- Real Numbers:
   - Dedekind reals
   - Cauchy reals
   - Escard√≥-Simpson reals

   HoTT 11.2 Dedekind reals
   HoTT 11.3 Cauchy reals

   Copyright (c) Groupoid Infinity, 2014-2022. -}

-- Mart√≠n H√∂tzel Escard√≥, Thomas Streicher, 1999
-- Induction and recursion on the partial real line with applications to Real PCF
-- https://core.ac.uk/download/pdf/82595986.pdf

-- Mart√≠n H√∂tzel Escard√≥, Alex Simpson, 2001
-- A Universal Characterisation of the Closed Euclidean Interval
-- https://www.cs.bham.ac.uk/~mhe/papers/interval.pdf

-- Mart√≠n H√∂tzel Escard√≥, Alex Simpson, 2014
-- Abstract Datatypes for Real Numbers in Type Theory
-- https://www.cs.bham.ac.uk/~mhe/papers/realadt.pdf
-- https://www.cs.bham.ac.uk/~mhe/agda-new/Escardo-Simpson-LICS2001.html

-- Auke Bart Booij, PhD 2020
-- Analysis in Univalent Type Theory
-- https://www.cs.bham.ac.uk/~abb538/thesis.pdf

-- Todd Waugh Ambridge, 2020
-- Formalising the Escard√≥-Simpson Closed Interval Axiomatisation in Univalent Type Theory
-- https://hott-uf.github.io/2020/HoTTUF_2020_paper_17.pdf
-- https://www.cs.bham.ac.uk/~mhe/agda-new/UF-SIP-IntervalObject.html

module real where
import library/foundations/univalent/path
import library/foundations/mltt/induction

def ‚â§‚ÇÇ (a b : ùüê) : U := Path ùüê a 0‚ÇÇ ‚Üí Path ùüê b 1‚ÇÇ
def is-decreasing (Œ± : ‚Ñï ‚Üí ùüê) : U := Œ† (i : ‚Ñï), ‚â§‚ÇÇ (Œ± (succ i)) (Œ± i)
def ‚Ñï‚àû : U := Œ£ (Œ± : ‚Ñï ‚Üí ùüê), is-decreasing Œ±
def incl (Œ± : ‚Ñï‚àû) : ‚Ñï ‚Üí ùüê := Œ±.1
def tail (A : U) (a : ‚Ñï ‚Üí A) : ‚Ñï ‚Üí A := \ (n : ‚Ñï), a (succ n)

def midpoint-alg (A : U) (O : A ‚Üí A ‚Üí A) : U‚ÇÅ :=
  Œ£ (isSet : isSet A)
    (idempodent : Œ† (a : A), Path A (O a a) a)
    (commutative : Œ† (x y : A), Path A (O x y) (O y x))
    (transpositional : Œ† (a b c d : A), Path A (O (O a b) (O c d)) (O (O a c) (O b d))), U

def convex-body : U‚ÇÅ :=
  Œ£ (A : U)
    (O : A ‚Üí A ‚Üí A)
    (midpoint : midpoint-alg A O)
    (cancelative : Œ† (a b c : A), Path A (O a c) (O b c) ‚Üí Path A a b)
    (iterative :
    Œ£ (M : Œ† (_ : ‚Ñï ‚Üí A), A)
      (x : Œ† (a : ‚Ñï ‚Üí A), Path A (M a) (O (a zero) (M (tail A a)))),
    Œ† (a x : ‚Ñï ‚Üí A) (y : Œ† (i : ‚Ñï), Path A (a i) (O (x i) (a (succ i)))),
      Path A (a zero) (M x)), U

def isSingleton (A: U) : U := Œ† (a: A), Œ£ (x: A), Path A a x
def ‚àÉ! (A : U) (B : A -> U) : U := isSingleton (Œ£ (x: A), B x)

def Interval-Object : U‚ÇÅ :=
  Œ£ (J : convex-body) (u v : J.A),
  Œ† (K : convex-body) (a b : K.A),
 ‚àÉ! (J.A -> K.A)
    ( Œª (h : J.A -> K.A),
      Œ£ (_ : Path (K.A) (h u) a) (_ : Path (K.A) (h v) b),
      Œ† (x y : J.A), Path K.A (h (J.O x y)) (K.O (h x) (h y)))

{- The key structure of the axiomatisation: an interval object.
   An interval object is defined by a convex-body J and two points u,v : J.A, such that
   For every two points a,b : K.A of a convex-body K there exists a unique h : J.A -> K.ob such that:
   h u ‚â° a /\ h v ‚â° b /\ ‚àÄ x,y : J.A, h (x J.O y) ‚â° h x K.O h y -}

-- Exact Real Arithmetics

-- Peter John Potts, 1996
-- Computable Real Arithmetic Using Linear Fractional Transformations
-- https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.24.7373&rep=rep1&type=pdf

-- Peter John Potts, Abbas Edalat, 1997
-- Exact Real Computer Arithmetic
-- http://www.doc.ic.ac.uk/research/technicalreports/1997/DTR97-9.pdf

-- Peter Potts, Abbas Edalat, Mart√≠n H√∂tzel Escard√≥, 1997
-- Semantics of Exact Real Arithmetic
-- https://www.researchgate.net/publication/221443275_Semantics_of_Exact_Real_Arithmetic

-- Reinhold Heckmann, 1998
-- The Appearance of Big Integers in Exact Real Arithmetic Based on Linear Fractional Transformations
-- https://link.springer.com/content/pdf/10.1007%2FBFb0053549.pdf

-- Peter John Potts, PhD, 1998
-- Exact Real Arithmetics using Mobius Transformations
-- https://www.doc.ic.ac.uk/~ae/papers/potts-phd.pdf

-- Peter John Potts, Abbas Edalat, 1998
-- A New Representation for Exact Real Numbers
-- https://www.sciencedirect.com/science/article/pii/S1571066105801665

