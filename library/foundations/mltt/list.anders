{- Run-Time List Type:
   - List;

   HoTT 5.3 W-Types

   Copyright (c) Groupoid Infinity, 2014-2022. -}

module list where
import library/foundations/mltt/maybe
option girard true

def List-ctor (A: U) := maybe-rec A U ğŸ (Î» (a : A), ğŸ)
def List (A: U) := W (x : Maybe A), List-ctor A x
def nil (A: U) : List A := sup (Maybe A) (List-ctor A) (nothing A) (indâ‚€ (List A))
def cons (A: U) (x : A) (xs: List A) : List A := sup (Maybe A) (List-ctor A) (just A x) (Î» (x : ğŸ), xs)

def List-ind (A: U) (C: List A -> U) (z: C (nil A)) (s: Î  (x: A) (xs: List A), C xs -> C (cons A x xs)) : Î  (n: List A), C n
 := indáµ‚ (Maybe A) (List-ctor A) C
    (maybe-ind A
      (Î» (x: Maybe A), Î  (f : List-ctor A x â†’ List A), (Î  (b : List-ctor A x), C (f b)) â†’ C (sup (Maybe A) (List-ctor A) x f))
      (Î» (f : ğŸ â†’ List A) (g : Î  (x : ğŸ), C (f x)), ?)
      (Î» (x: A) (f : ğŸ â†’ List A) (g : Î  (x : ğŸ), C (f x)), ?))
  
