{- Natural numbers.
   HoTT 5.3 W-Types

   Copyright Â© Groupoid Infinity, 2021â€”2022,
             Â© @siegment, 2022 -}

import library/data/W-type

def â„•-ctor := indâ‚‚ (Î» (_ : ğŸ), U) ğŸ ğŸ
def â„• := W (x : ğŸ), â„•-ctor x
def zero : â„• := sup ğŸ â„•-ctor 0â‚‚ (indâ‚€ â„•)
def succ (n : â„•) : â„• := sup ğŸ â„•-ctor 1â‚‚ (Î» (x : ğŸ), n)

def ğŸâŸ¶â„• (n : L) (C : â„• â†’ U n) (f : ğŸ â†’ â„•) : C zero â†’ C (sup ğŸ â„•-ctor 0â‚‚ f) :=
transp (<i> C (sup ğŸ â„•-ctor 0â‚‚ (Î» (x : ğŸ), indâ‚€ (PathP (<_> â„•) (indâ‚€ â„• x) (f x)) x @ i))) 0

def ğŸâŸ¶â„• (n : L) (C : â„• â†’ U n) (f : ğŸ â†’ â„•) : C (succ (f â˜…)) â†’ C (sup ğŸ â„•-ctor 1â‚‚ f) :=
transp (<i> C (sup ğŸ â„•-ctor 1â‚‚ (Î» (x : ğŸ), indâ‚ (Î» (y : ğŸ), PathP (<_> â„•) (f â˜…) (f y)) (<_> f â˜…) x @ i))) 0

def â„•-indÏ‰ (n : L) (C : â„• â†’ U n) (z : C zero) (s : Î  (m : â„•), C m â†’ C (succ m)) : Î  (m : â„•), C m :=
indáµ‚ C (indâ‚‚ (Î» (x : ğŸ), Î  (f : â„•-ctor x â†’ â„•), (Î  (b : â„•-ctor x), C (f b)) â†’ C (sup ğŸ â„•-ctor x f))
  (Î» (f : ğŸ â†’ â„•) (g : Î  (x : ğŸ), C (f x)), ğŸâŸ¶â„• n C f z)
  (Î» (f : ğŸ â†’ â„•) (g : Î  (x : ğŸ), C (f x)), ğŸâŸ¶â„• n C f (s (f â˜…) (g â˜…))))

def â„•-recÏ‰ (n : L) (C : U n) (z : C) (s : â„• â†’ C â†’ C) : â„• â†’ C := â„•-indÏ‰ n (Î» (_ : â„•), C) z s
def â„•-iterÏ‰ (n : L) (C : U n) (z : C) (s : C â†’ C) : â„• â†’ C := â„•-recÏ‰ n C z (Î» (_ : â„•), s)
def â„•-caseÏ‰ (n : L) (C : U n) (z s : C) : â„• â†’ C := â„•-iterÏ‰ n C z (Î» (_ : C), s)

def â„•-ind  := â„•-indÏ‰ Lâ‚€
def â„•-rec  := â„•-recÏ‰ Lâ‚€
def â„•-iter := â„•-iterÏ‰ Lâ‚€
def â„•-case := â„•-indÏ‰ Lâ‚€

def plus : â„• â†’ â„• â†’ â„• := â„•-iter (â„• â†’ â„•) (idfun â„•) (âˆ˜ â„• â„• â„• succ)
def mult : â„• â†’ â„• â†’ â„• := â„•-rec (â„• â†’ â„•) (Î» (_ : â„•), zero) (Î» (_ : â„•) (x : â„• â†’ â„•) (m : â„•), plus m (x m))
def one : â„• := succ zero
def two : â„• := succ one
def three : â„• := succ two
def four : â„• := succ three
def five : â„• := succ four

def 5â€² : â„• := plus two three
def 10â€² : â„• := mult 5â€² two
def 55â€² : â„• := plus (mult 5â€² 10â€²) 5â€²