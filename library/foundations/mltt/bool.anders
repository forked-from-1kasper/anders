{- Run-time Homotopy-inductive types:
   - Bool type (0-Sphere).
   - Theorems are in bool_theory module.

   HoTT 1.8 The type of booleans

   Copyright (c) Groupoid Infinity, 2014-2022. -}

module bool where
import library/foundations/mltt/proto

def recâ‚‚ (A : U) (a b : A) : ğŸ â†’ A := indâ‚‚ (Î» (_ : ğŸ), A) a b

-- data ğŸ : U := 0â‚‚ | 1â‚‚

def not : ğŸ â†’ ğŸ := recâ‚‚ ğŸ 1â‚‚ 0â‚‚
def and : ğŸ â†’ ğŸ â†’ ğŸ := recâ‚‚ (ğŸ â†’ ğŸ) (const ğŸ ğŸ 0â‚‚) (id ğŸ)
def or  : ğŸ â†’ ğŸ â†’ ğŸ := recâ‚‚ (ğŸ â†’ ğŸ) (id ğŸ) (const ğŸ ğŸ 1â‚‚)
def xor : ğŸ â†’ ğŸ â†’ ğŸ := recâ‚‚ (ğŸ â†’ ğŸ) (id ğŸ) not

def HA (a b : ğŸ) : ğŸ Ã— ğŸ := (xor a b, and a b)

def orÂ² (a : ğŸ) (w : ğŸ Ã— ğŸ) : ğŸ Ã— ğŸ := (w.1, or a w.2)
def FA (a b cáµ¢â‚™ : ğŸ) : ğŸ Ã— ğŸ := orÂ² (HA a b).2 (HA (HA a b).1 cáµ¢â‚™)

def add-2bit (a b : ğŸ Ã— ğŸ) : ğŸ Ã— ğŸ :=
((FA a.1 b.1 (HA a.2 b.2).2).1, (HA a.2 b.2).1)

-- Church

def boolâ€² := Î  (Î± : U), Î± â†’ Î± â†’ Î±

def trueâ€²  : boolâ€² := Î» (Î± : U) (t f : Î±), t
def falseâ€² : boolâ€² := Î» (Î± : U) (t f : Î±), f

def ite (Î± : U) (a b : Î±) (f : boolâ€²) : Î± := f Î± a b
