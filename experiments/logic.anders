module logic where
import library/foundations/mltt/either

def Â¬ (A : U) := A â†’ ğŸ
def CL (A : U) := Â¬ (Â¬ A)

-- Theorem 1.17
-- https://electives.hse.ru/data/2017/10/16/1159321542/Book-Part2.pdf

def IPCâ†’CL (A : U) : A â†’ CL A := Î» (x : A) (Ï† : Â¬ A), Ï† x

def classical-dneg (A : U) : CL (Â¬ (Â¬ A) â†’ A)
 := Î» (f : Â¬ (Â¬ (Â¬ A) â†’ A)), f (Î» (g : Â¬ (Â¬ A)), indâ‚€ A (g (Î» (x : A), f (Î» (h : Â¬ (Â¬ A)), x))))

def classical-lem (A : U) : CL (+ (Â¬ A) A)
 := Î» (f : Â¬ (+ (Â¬ A) A)), f (0â‚‚, Î» (x : A), f (1â‚‚, x))

def classical-mp (A B : U) : CL A â†’ CL (A â†’ B) â†’ CL B
 := Î» (f : CL A) (g : CL (A â†’ B)) (h : Â¬ B), g (Î» (Ï† : A â†’ B), f (Î» (x : A), h (Ï† x)))

def classical-linearity (A B : U) : CL (+ (A â†’ B) (B â†’ A))
 := Î» (f : Â¬ (+ (A â†’ B) (B â†’ A))), f (0â‚‚, Î» (x : A), indâ‚€ B (f (1â‚‚, Î» (y : B), x)))

def classical-deduction (A B : U) : (CL A â†’ CL B) â†’ CL (A â†’ B)
 := Î» (f : CL A â†’ CL B) (g : Â¬ (A â†’ B)), f (Î» (h : Â¬ A), g (Î» (x : A), indâ‚€ B (h x))) (Î» (y : B), g (Î» (x : A), y))

def classical-prod-intro (A B : U) (a : CL A) (b : CL B) : CL (A Ã— B) :=
classical-mp B (A Ã— B) b
  (classical-mp A (B â†’ A Ã— B) a
    (IPCâ†’CL (A â†’ B â†’ A Ã— B)
      (Î» (aâ€² : A) (bâ€² : B), (aâ€², bâ€²))))

def classical-prâ‚ (A B : U) (Ï† : CL (A Ã— B)) : CL A :=
classical-mp (A Ã— B) A Ï† (IPCâ†’CL ((A Ã— B) â†’ A) (Î» (w : A Ã— B), w.1))

def classical-prâ‚‚ (A B : U) (Ï† : CL (A Ã— B)) : CL B :=
classical-mp (A Ã— B) B Ï† (IPCâ†’CL ((A Ã— B) â†’ B) (Î» (w : A Ã— B), w.2))

